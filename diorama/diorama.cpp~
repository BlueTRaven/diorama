#include <glad\glad.h>
#include <GLFW\glfw3.h>

#include "diorama.h"
#include "vertex_handler.h"

void update()
{
	double time = glfwGetTime();
}

void update_input()
{
	glfwPollEvents();
}

void draw(GLint program)
{
	GLFWwindow *window = glfwGetCurrentContext();

	int width, height;
	float ratio;

	glfwGetFramebufferSize(window, &width, &height);
	ratio = width / (float)height;

	glViewport(0, 0, width, height);
	glClearColor(0.0f, 0.0f, 0.1f, 0.0f);
	glClear(GL_COLOR_BUFFER_BIT | GL_DEPTH_BUFFER_BIT);

	glUseProgram(program);

	glBindBuffer(GL_ARRAY_BUFFER, vertex_buffer);

	GLint attrib_position = vertex_attribute(program, "position", 3, sizeof(Vertex), (void*)0);
	GLint attrib_tex_coord = vertex_attribute(program, "tex_coord", 2, sizeof(Vertex), (void*)offsetof(Vertex, tex_coords));
	GLint attrib_color = vertex_attribute(program, "color", 4, sizeof(Vertex), (void*)offsetof(Vertex, color));
		
	//GLint attrib_position = glGetAttribLocation(program, "position");
	//GLint attrib_tex_coord = glGetAttribLocation(program, "tex_coord");
	//GLint attrib_color = glGetAttribLocation(program, "color");

	//glEnableVertexAttribArray(attrib_position);
	//glEnableVertexAttribArray(attrib_tex_coord);
	//glEnableVertexAttribArray(attrib_color);
	
	//glVertexAttribPointer(attrib_position, 3, GL_FLOAT, GL_FALSE, sizeof(Vertex), (void*)0);
	//glVertexAttribPointer(attrib_tex_coord, 2, GL_FLOAT, GL_FALSE, sizeof(Vertex), (void*)offsetof(Vertex, tex_coords));
	//glVertexAttribPointer(attrib_color, 4, GL_FLOAT, GL_FALSE, sizeof(Vertex), (void*)offsetof(Vertex, color));

	//glBindAttribLocation(program, attrib_position, "position");
	//glBindAttribLocation(program, attrib_tex_coord, "tex_coord");
	//glBindAttribLocation(program, attrib_color, "color");

	glDrawArrays(GL_TRIANGLES, 0, 3);

 	glDisableVertexAttribArray(attrib_position);
	glDisableVertexAttribArray(attrib_tex_coord);
	glDisableVertexAttribArray(attrib_color);

	glfwSwapBuffers(window);
}
